{% extends 'base.html' %}

{% block title %}Register{% endblock %}

{% block content %}
<div class="card" style="max-width: 500px; margin: 50px auto;">
    <h2 style="margin-bottom: 20px; color: #333;">Create New Account</h2>
    
    <form method="post" style="display: flex; flex-direction: column; gap: 15px;">
        {# ✅ SECURE: CSRF token automatically included by Flask-WTF #}
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
        
        <div>
            <label for="username" style="display: block; margin-bottom: 5px; font-weight: bold;">Username:</label>
            <input 
                type="text" 
                name="username" 
                id="username" 
                required
                minlength="3"
                style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;"
            >
            <small style="color: #666; font-size: 12px;">Minimum 3 characters</small>
        </div>

        <div>
            <label for="email" style="display: block; margin-bottom: 5px; font-weight: bold;">Email:</label>
            <input 
                type="email" 
                name="email" 
                id="email" 
                required
                style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;"
            >
        </div>

        <div>
            <label for="full_name" style="display: block; margin-bottom: 5px; font-weight: bold;">Full Name:</label>
            <input 
                type="text" 
                name="full_name" 
                id="full_name"
                style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;"
            >
        </div>

        <div>
            <label for="password" style="display: block; margin-bottom: 5px; font-weight: bold;">Password:</label>
            <input 
                type="password" 
                name="password" 
                id="password" 
                required
                minlength="6"
                style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;"
            >
            <small style="color: #666; font-size: 12px;">Minimum 6 characters</small>
        </div>

        <button 
            type="submit"
            style="padding: 12px; background-color: #28a745; color: white; border: none; border-radius: 4px; font-size: 16px; cursor: pointer; font-weight: bold;"
        >
            Register
        </button>
    </form>

    <p style="margin-top: 20px; text-align: center;">
        Already have an account? 
        <a href="{{ url_for('auth.login') }}" style="color: #007bff; text-decoration: none; font-weight: bold;">Login here</a>
    </p>

    <!-- Security Info -->
    <div style="margin-top: 30px; padding: 15px; background-color: #d4edda; border: 1px solid #c3e6cb; border-radius: 4px;">
        <h4 style="margin-bottom: 10px; color: #155724;">✅ Security Features:</h4>
        <ul style="color: #155724; font-size: 14px; margin-left: 20px;">
            <li>✅ Passwords stored using secure hashing (werkzeug.security)</li>
            <li>✅ Input validation and sanitization</li>
            <li>✅ CSRF token protection</li>
            <li>✅ Password strength requirements</li>
        </ul>
    </div>
</div>
{% endblock %}

