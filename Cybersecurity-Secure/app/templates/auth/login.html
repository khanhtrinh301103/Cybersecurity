{% extends 'base.html' %}

{% block title %}Login{% endblock %}

{% block content %}
<div class="card" style="max-width: 500px; margin: 50px auto;">
    <h2 style="margin-bottom: 20px; color: #333;">Login to Your Account</h2>
    
    <form method="post" style="display: flex; flex-direction: column; gap: 15px;">
        {# ✅ SECURE: CSRF token automatically included by Flask-WTF #}
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
        
        <div>
            <label for="username" style="display: block; margin-bottom: 5px; font-weight: bold;">Username:</label>
            <input 
                type="text" 
                name="username" 
                id="username" 
                required
                style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;"
            >
        </div>

        <div>
            <label for="password" style="display: block; margin-bottom: 5px; font-weight: bold;">Password:</label>
            <input 
                type="password" 
                name="password" 
                id="password" 
                required
                style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;"
            >
        </div>

        <button 
            type="submit"
            style="padding: 12px; background-color: #007bff; color: white; border: none; border-radius: 4px; font-size: 16px; cursor: pointer; font-weight: bold;"
        >
            Login
        </button>
    </form>

    <p style="margin-top: 20px; text-align: center;">
        Don't have an account? 
        <a href="{{ url_for('auth.register') }}" style="color: #007bff; text-decoration: none; font-weight: bold;">Register here</a>
    </p>

    <!-- Security Info Box -->
    <div style="margin-top: 30px; padding: 15px; background-color: #d4edda; border: 1px solid #c3e6cb; border-radius: 4px;">
        <h4 style="margin-bottom: 10px; color: #155724;">✅ Security Features:</h4>
        <ul style="list-style: none; padding-left: 0; color: #155724; font-size: 14px;">
            <li>✅ SQL Injection protection (parameterized queries)</li>
            <li>✅ Password verification using secure hashing</li>
            <li>✅ CSRF token protection</li>
            <li>✅ Input validation</li>
        </ul>
    </div>
</div>
{% endblock %}

